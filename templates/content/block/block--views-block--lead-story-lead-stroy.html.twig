<style>
  .lead-story-item {
    position: relative; /* Ensure the flag can be positioned within */
  }

  .lead-story-flag {
    background-color: rgba(255, 215, 0, 0.9); /* Gold with slight transparency */
    color: #000; /* Black text */
    font-weight: bold;
    border-radius: 5px;
    display: flex;
    align-items: center;
  }

  .lead-story-flag i {
    font-size: 0.85rem;
  }

  .lead-story-flag-title {
    font-size: 0.85rem;
  }
</style>

<div class="lead-story-block d-flex flex-wrap justify-content-between py-3">
	{% if content['#view'] %}
		{% set view = content['#view'] %}
		{% if view.result %}
			{% for row in view.result %}
				<div class="lead-story-item col-12 col-md-6 col-lg-3 p-3">
					{% if row._entity %}
						{% set node = row._entity %}
						
						<a href="{{ node.field_link.uri }}" class="cta-link" aria-label="Read {{ node.label }}">
							
							{# Render flag only if field_flag_on is set to "flag_on" #}
							{% if node.field_flag_on.value == 'flag_on' %}
								<div class="lead-story-flag position-absolute start-0 top-0 p-2">
									{% if node.field_flag_icon.value %}
										<i class="{{ node.field_flag_icon.value }} fa-sm me-1"></i>
									{% endif %}
									<span class="lead-story-flag-title">{{ node.field_flag_title.value }}</span>
								</div>
							{% endif %}
							{# Render the Image Field #}
							{% if node.field_image.entity.uri.value %}
								<div class="card-header mb-2">
									<img src="{{ file_url(node.field_image.entity.uri.value) }}" alt="{{ node.field_image.alt }}" class="img-fluid">
								</div>
							{% endif %}
							
							{# Render the Title as a Link (if field_link exists) #}
							<h3 class="lead-story-title display-4 text-white mb-2">{{ node.label }}</h3>
							
							{# Render the Body Field #}
							{% if node.body.value %}
								<div class="lead-story-body text-white mb-2">
									<p>{{ node.body.value|raw }}</p>
								</div>
							{% endif %}
							
							{# Call to Action Button - use text from field_link #}
							<div class="card-footer d-flex p-0 mb-5">
                                <span class="card-link btn outline-btn-cu-bg-light-grey text-decoration-none p-2 mt-3 text-white">
                                    {% if node.field_link.title %}
	                                    {{ node.field_link.title }}
                                    {% else %}
	                                    {{ node.label }}
                                    {% endif %}
                                </span>
							</div>
						
						</a>
					{% endif %}
				</div>
			{% endfor %}
		{% endif %}
	{% endif %}
</div>

{% if row._entity %}
	{% set node = row._entity %}
	<a href="{{ node.url }}" class="view-link">
		View Content
	</a>
{% endif %}