{# Card Image #}

{# Add optional variables based on conditions #}
{% set aria_label = link_title is not empty ? (label is not empty and link_title in ['Learn More', 'Read More', 'More Information'] ? link_title|title ~ ' About ' ~ label|title : link_title) : '' %}
{% set image_size = image_size ?? '' %}

{# Concatenate optional classes with a space #}
{% set card_image_classes = [
    'card-header',
    position_container is not empty ? 'd-flex ' ~ position_container : null,
    text_alignment is not empty ? text_alignment : null,
    text_color is not empty ? text_color : null,
    'g-0',
] | join(' ') %}

{# Content #}
{% if card_image %}

    {# Link wrapper if active #}
    {% block link_wrapper %}
        {% if link_title is not empty %}
            <a href="{{ link_url }}" title="{{ aria_label }}" aria-label="{{ aria_label }}">
        {% endif %}
    {% endblock %}

    {# Card Image #}
    <div{{ attributes.addClass(card_image_classes|trim) }}>
        <div role="presentation" class="card-img {{ image_size }} {% if link_title is not empty %}img-hover-effect{% endif %}">
            {# Card Image #}
            {{ card_image }}
            {# Card Image Caption #}
            {% if content.field_image is not empty %}
                {# Render the image #}
                {% for item in content.field_image %}
                    {% if item['#item'].alt is not empty %}
                        <figcaption class="{{ visibility }}">
                            <p class="figcaption {{card_image_classes|trim }}">{{ item['#item'].alt }}</p>
                        </figcaption>
                    {% endif %}
                {% endfor %}
            {% endif %}
        </div>
    </div>

    {# Link wrapper if active #}
    {% block link_wrapper_close %}
        {% if link_title is not empty %}
            </a>
        {% endif %}
    {% endblock %}

{% endif %}

